window,define(["jquery","lodash","chrome_lib","nimbus/tour","jsUri"],function(c,s,i,a,d){var r=3e3;function l(){var a=i.store.local.get("dismissedToasts");return a||(i.store.local.set("dismissedToasts",[]),a=i.store.local.get("dismissedToasts")),a}function n(r){var n=r.attr("id");r.find(".btn, button, .close").on("click",function(a){r.removeClass("show");var o,t,e=c(this),s=e.attr("href");new d(s),new d(window.location.href);(e.hasClass("close")||e.hasClass("dismiss")||e.hasClass("done"))&&(a.preventDefault(),"autotoast"===r.attr("data-action")&&(o=n,(t=l()).push(o),i.store.local.set("dismissedToasts",t)),e.hasClass("done")&&s&&(window.location.href=s))})}function m(a){a.addClass("show")}function p(o,t){var e=c("body");o.on("click",function(a){a.preventDefault(),function(a,o){var t=c("body"),e=a.attr("title")?a.attr("title"):"",s="",r="",n=!1;if(null!==o.match(/\.(jpeg|jpg|gif|png)/))s='<img src="'+o+'" alt="'+e+'">',r='<div class="zoom-larger"><a href="'+o+'" title="Opens in a new window" target="_blank">View larger image<span class="sr-only"> (Opens in a new window)</span></a></div>',n=!0;else{var i=o.match(/youtube\.com\/(watch\?v=|embed\/)(\w*)[\&\?](.*\=.*)/);if(null!=i){var d=a.attr("data-aspect-ratio");null==d&&(d="16:9"),s='<div class="video-wrapper" data-aspect-ratio="'+d+'"><iframe width="560" height="315" src="'+("https://www.youtube.com/embed/"+i[2]+"?"+i[3]+"&rel=0")+'" target="_parent" frameborder="0" allowfullscreen></iframe></div>',n=!(r="")}}n&&(t.addClass("zoom-open"),t.append('<div class="zoom-modal in" tabindex="-1" role="dialog"><div class="zoom-wrap"><button type="button" class="close" aria-hidden="true">Ã—</button><div class="zoom-body">'+s+"</div>"+r+"</div></div>"),t.append('<div class="zoom-backdrop in"></div>'))}(o,t)}),e.on("click",function(a){var o=c(a.target),t=o.attr("class");("close"===t&&o.parent().hasClass("zoom-wrap")||"zoom-modal in"===t||"zoom-backdrop in"===t)&&(c(".zoom-modal, .zoom-backdrop").remove(),e.removeClass("zoom-open"))}),document.body.addEventListener("keydown",function(a){var o=c(".zoom-modal, .zoom-backdrop");if(c(e).hasClass("zoom-open"))switch(a.key){case"Esc":case"Escape":o.remove(),e.removeClass("zoom-open");default:return}})}c("[data-action]").each(function(){var a,o,t=c(this),e=t.attr("data-action");"toast"===e?(a=c(t.attr("href")),o=a,t.on("click",function(a){a.preventDefault(),m(o)}),n(o)):"autotoast"===e?function(a){var o=l(),t=a.attr("id"),e=a.attr("data-toast-delay")||r;if(-1===o.indexOf(t))s.delay(s.partial(m,a),e);n(a)}(t):"zoom"===e?(href=t.attr("href"),p(t,href)):"modal"===e&&function(){c("[data-cp-modal-target]").on("click",function(a){a.preventDefault();var o=c(c(this).attr("data-cp-modal-target"));o.addClass("in"),o.next(".cp-modal-backdrop").addClass("in")});var e=c("body");e.on("click",function(a){var o=c(a.target),t=o.attr("class");!o.hasClass("cp-modal-close")&&"cp-modal in"!==t&&"cp-modal-backdrop in"!==t||(c(".cp-modal, .cp-modal-backdrop").removeClass("in"),e.removeClass("cp-modal-open"))}),document.body.addEventListener("keydown",function(a){var o=c(".cp-modal, .cp-modal-backdrop");if(c(e).hasClass("cp-modal-open"))switch(a.key){case"Esc":case"Escape":o.removeClass("in"),e.removeClass("cp-modal-open");default:return}})}()}),c(".rh_docs .inlinemediaobject img, .rh_docs .mediaobject img").each(function(){var a=c(this),o=new Image,t=c(".doc-wrapper").width();o.src=a.attr("src"),o.naturalWidth>t&&(href=a.attr("src"),title=a.attr("alt"),a.wrap('<a href="'+href+'" class="rh_docs--zoom" title="'+title+'"></a>'),p(a.parent(),href))})});
//# sourceMappingURL=data-action.js.map